目标：库存管理模块设计与实现

## 数据库实体

- [inbound_orders.sql](doc/inbound_orders.sql)
- [inbound_order_items.sql](doc/inbound_order_items.sql)
- [inbound_shipments.sql](doc/inbound_shipments.sql)
- [inbound_exceptions.sql](doc/inbound_exceptions.sql)

## 业务逻辑

### 入库单创建
- 商户创建“入库单”，默认状态是“草稿”，可以在草稿状态下添加商品。
- 每个入库单可以创建多个包裹（inbound_order_packages）
- 可以在每个包裹里添加商品（通过product的styleNumber找到对应的商品信息）
- 只可以添加已存在的商品，不能添加新商品
- 添加商品的必要信息是：商品的styleNumber、尺码、数量

### 入库单确认
- 商户可以确认入库单，状态变更为“待发货”，将不能再添加商品。

### 入库单发货
- 商户可以填入物流单信息，状态变更为“已发货”。
- 每个包裹可以独立一个物流单，也可以合并到一个物流单（inbound_shipments）
- 预报入库单给到仓库系统（API对接）
- 商家库存开始增加（在途库存）

### 入库单签收清点
- 平台根据仓库作业反馈可以标记入库单为“已完成”，状态变更为“已完成”。
- 商家库存增加（在途库存减少，在仓库存增加）

### 入库单差异处理
- 入库单状态更新为：“异常”
- 平台可以根据仓库作业反馈，判断是否有数量差异
- 如果有数量差异，需要在系统中记录下来生成异常单（inbound_exceptions）
- 差异单可以是“增加”或“减少”，记录差异数量和差异原因
- 库存依旧卡在“在途库存”中，等待商户核实处理

### 异常单处理
- 商户可以查看异常单，确认是否是错误操作导致的数量差异
- 如果是错误操作，商户可以联系平台客服，平台客服可以在异常单上备注“错误操作”
- 如果是正常操作，商户需要联系商家，确认数量是否正确
- 商家确认数量正确后，需要在系统中更新库存，将异常单状态更新为“已处理”
